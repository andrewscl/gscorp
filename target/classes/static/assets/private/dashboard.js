import{i as y}from"../chunks/echarts-setup-BOxioT3i.js";async function g(t,a={}){const n=localStorage.getItem("jwt"),o=new Headers(a.headers||{});n&&o.set("Authorization",`Bearer ${n}`);const r=await fetch(t,{...a,headers:o});return r.status===401&&(localStorage.removeItem("jwt"),window.location.href="/auth/signin"),r}async function p({container:t}){const a=t.querySelector("#dashboard-root")||t;if(a.dataset.echartsInit==="1")return;a.dataset.echartsInit="1";const n=a.querySelector("#chart-attendance");if(!n){console.warn("[attendance chart] #chart-attendance no existe");return}const o=w(),r=`${o}-01`,m=S(o);let c=[];try{const e=await g(`/api/attendance/series?from=${r}&to=${m}&action=IN`);e.ok?c=await e.json():console.warn("[attendance chart] API status:",e.status,await e.text().catch(()=>""))}catch(e){console.warn("[attendance chart] fetch error",e)}const h=c.map(e=>e.x),d=c.map(e=>e.y),f=d.some(e=>Number(e)>0),s=y(n,void 0,{renderer:"canvas"});s.setOption({tooltip:{trigger:"axis"},legend:{show:!0},grid:{left:40,right:16,top:24,bottom:32},xAxis:{type:"category",boundaryGap:!1,data:h},yAxis:{type:"value"},series:[{name:"Entradas",type:"line",smooth:!0,areaStyle:{},data:d}],graphic:f?{elements:[]}:{elements:[{type:"text",left:"center",top:"middle",style:{text:"Sin datos",fill:"#9ca3af",fontSize:14}}]}});const l=new ResizeObserver(()=>s.resize());l.observe(n),requestAnimationFrame(()=>s.resize());const u=()=>{document.removeEventListener("fragment:will-unload",u);try{l.disconnect()}catch{}try{s.dispose()}catch{}};document.addEventListener("fragment:will-unload",u,{once:!0})}function i(){const t=document.getElementById("dashboard-root")||document.body;p({container:t})}document.addEventListener("content:loaded",i);document.readyState==="loading"?document.addEventListener("DOMContentLoaded",i):i();function w(t=new Date){return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`}function S(t){const[a,n]=t.split("-").map(Number),o=new Date(a,n,0);return`${t}-${String(o.getDate()).padStart(2,"0")}`}
