import{f as k}from"../../auth.js";import{n as m}from"../../navigation-handler.js";const e=t=>document.querySelector(t);function b(){const t=e("#createBankModal");t&&(t.classList.remove("hidden"),t.setAttribute("aria-hidden","false"),document.body.classList.add("no-scroll"),setTimeout(()=>e("#bankName")?.focus(),0))}function s(){const t=e("#createBankModal");if(!t)return;t.classList.add("hidden"),t.setAttribute("aria-hidden","true"),document.body.classList.remove("no-scroll"),e("#createBankForm")?.reset();const n=e("#createBankError"),a=e("#createBankOk");n&&(n.textContent=""),a&&(a.style.display="none")}async function f(){b()}async function y(t){t.preventDefault();const n=e("#createBankError"),a=e("#createBankOk");n&&(n.textContent=""),a&&(a.style.display="none");const c=e("#bankName")?.value?.trim(),l=e("#bankCode")?.value?.trim(),d=!!e("#bankActive")?.checked,u=e("#bankLogoUrl")?.value?.trim()||null;if(!c){n&&(n.textContent="El nombre del banco es obligatorio.");return}if(!l){n&&(n.textContent="El cÃ³digo del banco es obligatorio.");return}const r=t.submitter||e('#createBankForm button[type="submit"]');r&&(r.disabled=!0);try{const o=await k("/api/banks/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:c,code:l,logoUrl:u,active:d})});if(!o.ok){let i="";try{i=await o.text()}catch{}throw i||(i=`Error ${o.status}`),new Error(i)}a&&(a.style.display="block"),setTimeout(()=>{s(),m("/private/banks/table-view")},600)}catch(o){n&&(n.textContent=o.message||"No se pudo crear el banco")}finally{r&&(r.disabled=!1)}}function v(){e("#createBankBtn")?.addEventListener("click",f),e("#closeCreateBank")?.addEventListener("click",s),e("#cancelCreateBank")?.addEventListener("click",s),e("#createBankForm")?.addEventListener("submit",y),document.addEventListener("keydown",t=>{t.key==="Escape"&&s()})}(function(){v()})();
