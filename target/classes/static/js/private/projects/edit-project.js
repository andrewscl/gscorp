document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("editProjectForm"),e=document.getElementById("editProjectError"),o=document.getElementById("editProjectOk"),n=document.querySelector(".vs-btn.vs-secondary[data-path]"),l=()=>{e.textContent="",o.style.display="none"};n&&n.addEventListener("click",a=>{a.preventDefault(),window.location.href=n.getAttribute("data-path")}),t&&t.addEventListener("submit",async a=>{a.preventDefault(),l();const r=document.querySelector(".meta-id span")?.textContent?.trim(),s=t.projectName.value.trim(),p=t.projectDescription.value.trim(),i=t.projectClient.value,d=t.projectStartDate.value,m=t.projectEndDate.value,u=t.projectActive.checked;if(!s||!i||!d){e.textContent="Nombre, cliente y fecha inicio son obligatorios.";return}const v={id:r,name:s,description:p,clientId:i,startDate:d,endDate:m,active:u};try{const c=await fetch(`/api/projects/edit/${r}`,{method:"PUT",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(v)});if(c.ok)o.style.display="",o.textContent="Cambios guardados âœ…",setTimeout(()=>{window.location.href="/private/projects/table-view"},1e3);else{const y=await c.json().catch(()=>({}));e.textContent=y.message||"Error al guardar los cambios."}}catch{e.textContent="No se pudo conectar con el servidor."}})});
