import{f as p}from"../../auth.js";import{n as d}from"../../navigation-handler.js";const e=t=>document.querySelector(t);async function v(t){t.preventDefault();const r=e(".alert-success"),a=e(".alert-error"),o=Number(e("#siteId")?.value),i=e("#patrolName")?.value?.trim(),c=Number(e("#dayFrom")?.value),l=Number(e("#dayTo")?.value),u=e("#startTime")?.value;if(!o||!i||!c||!l||!u){n(a,"Por favor, complete todos los campos obligatorios.");return}try{const s=await p("/api/patrols/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({siteId:o,patrolName:i,dayFrom:c,dayTo:l,startTime:u})});if(!s.ok){const m=await s.json();n(a,`Error: ${m.message||"Ocurrió un problema al enviar el formulario."}`);return}n(r,"¡Formulario enviado correctamente!"),setTimeout(()=>{d("/private/sites/table-view")},3e3)}catch(s){console.error(`[onClickCreate] Ocurrio un problema: ${s.message}`,s),n(a,"Error inesperado. Intente más tarde.")}}async function y(t){t.preventDefault();const r=e(".alert-cancel");n(r,"La creación de la ronda de supervisión ha sido cancelada."),setTimeout(()=>{d("/private/sites/table-view")},3e3)}function n(t,r,a=5e3){const o=e(".patrol-alert-container");o.style.display="block";const i=t.querySelector(".alert-message");i.textContent=r,t.classList.add("alert-show"),setTimeout(()=>{t.classList.remove("alert-show"),o.style.display="none"},a)}function f(){e("#createPatrolBtn")?.addEventListener("click",v),e("#cancelCreatePatrolBtn")?.addEventListener("click",y)}(function(){f()})();
