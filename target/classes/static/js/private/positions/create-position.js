import{f}from"../../auth.js";import{n as a}from"../../navigation-handler.js";const t=e=>document.querySelector(e);async function v(e){e.preventDefault();const c=t("#positionName")?.value?.trim(),u=t("#positionDescription")?.value?.trim()||null,p=t("#positionCode")?.value?.trim()||null,l=t("#positionLevel")?.value?.trim(),m=l?Number(l):null,d=!!t("#positionActive")?.checked,i=t("#createPositionError"),n=t("#createPositionOk");if(i&&(i.textContent=""),n&&(n.style.display="none"),!c){i&&(i.textContent="El nombre del cargo es obligatorio.");return}const s=e.submitter||t('#createPositionForm button[type="submit"]');s&&(s.disabled=!0);try{const o=await f("/api/positions/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:c,description:u,code:p,level:m,active:d})});if(!o.ok){let r="";try{r=await o.text()}catch{}throw r||(r=`Error ${o.status}`),new Error(r)}n&&(n.style.display="block"),setTimeout(()=>{a("/private/positions/table-view")},600)}catch(o){i&&(i.textContent=o.message)}finally{s&&(s.disabled=!1)}}function b(){t("#createPositionForm")?.addEventListener("submit",v)}function y(){t("#cancelCreatePosition")?.addEventListener("click",e=>{e.preventDefault(),a("/private/positions/table-view")})}function C(){t("#closeCreatePosition")?.addEventListener("click",e=>{e.preventDefault(),a("/private/positions/table-view")})}(function(){b(),y(),C()})();
