import{f as H}from"../../auth.js";import{n as W}from"../../navigation-handler.js";console.log("create-employee.js cargado");const t=o=>document.querySelector(o);async function G(o){o.preventDefault();const m=t("#employeeName")?.value?.trim(),y=t("#employeeFatherSurname")?.value?.trim()||null,d=t("#employeeMotherSurname")?.value?.trim()||null,h=t("#employeeRut")?.value?.trim()||null,v=t("#employeeMail")?.value?.trim()||null,f=t("#employeePhone")?.value?.trim()||null,S=t("#employeeSecondaryPhone")?.value?.trim()||null,b=t("#employeeGender")?.value?.trim()||null,k=t("#employeeNationality")?.value?.trim()||null,D=t("#employeeMaritalStatus")?.value?.trim()||null,P=t("#employeeStudyLevel")?.value?.trim()||null,A=t("#employeeProfession")?.value?.trim()||null,E=t("#employeePrevitionalSystem")?.value?.trim()||null,N=t("#employeeHealthSystem")?.value?.trim()||null,T=t("#employeePaymentMethod")?.value?.trim()||null,g=t("#employeeBankName")?.value?.trim()||null,w=t("#employeeBankAccountType")?.value?.trim()||null,x=t("#employeeBankAccountNumber")?.value?.trim()||null,C=t("#employeeContractType")?.value?.trim()||null,M=t("#employeeWorkSchedule")?.value?.trim()||null,j=t("#employeeShiftSystem")?.value?.trim()||null,B=t("#employeePosition")?.value?.trim()||null,I=t("#employeeAddress")?.value?.trim()||null,F=t("#employeeHireDate")?.value||null,L=t("#employeeBirthDate")?.value||null,O=t("#employeeExitDate")?.value||null,q=!!t("#employeeActive")?.checked,i=t("#employeeUser")?.value||null;let s=[];const u=t("#employeeProjects");u&&(s=Array.from(u.selectedOptions).map(e=>e.value).filter(Boolean));const a=t("#employeePhoto");let p=null;a&&a.files&&a.files[0]&&(p=a.files[0]);const n=t("#createEmployeeError"),l=t("#createEmployeeOk");if(n&&(n.textContent=""),l&&(l.style.display="none"),!m){n&&(n.textContent="El nombre es obligatorio.");return}if(!i){n&&(n.textContent="Debe seleccionar un usuario asociado.");return}try{const e=new FormData;e.append("name",m),e.append("fatherSurname",y),e.append("motherSurname",d),e.append("rut",h),e.append("mail",v),e.append("phone",f),e.append("secondaryPhone",S),e.append("gender",b),e.append("nationality",k),e.append("maritalStatus",D),e.append("studyLevel",P),e.append("profession",A),e.append("previtionalSystem",E),e.append("healthSystem",N),e.append("paymentMethod",T),e.append("bankName",g),e.append("bankAccountType",w),e.append("bankAccountNumber",x),e.append("contractType",C),e.append("workSchedule",M),e.append("shiftSystem",j),e.append("position",B),e.append("address",I),e.append("hireDate",F),e.append("birthDate",L),e.append("exitDate",O),e.append("active",q),e.append("userId",i),s.forEach(r=>e.append("projectIds",r)),p&&e.append("photo",p);const c=await H("/api/employees/create",{method:"POST",body:e});if(!c.ok){const r=await c.text().catch(()=>"");throw new Error(r||"No se pudo crear el empleado")}l&&(l.style.display="block"),setTimeout(()=>{W("/private/employees/table-view")},600)}catch(e){n&&(n.textContent=e.message)}}function R(){t("#createEmployeeForm")?.addEventListener("submit",G)}(function(){R()})();
