import{f as v}from"../../auth.js";import{n as f}from"../../navigation-handler.js";const t=n=>document.querySelector(n);async function P(n){n.preventDefault();const l=t("#shiftPatternName")?.value?.trim(),b=t("#shiftPatternCode")?.value?.trim()||null,u=t("#shiftPatternDescription")?.value?.trim()||null,d=t("#shiftPatternWorkDays")?.value?.trim(),m=t("#shiftPatternRestDays")?.value?.trim(),h=t("#shiftPatternStartDay")?.value?.trim(),y=!!t("#shiftPatternActive")?.checked,a=d?Number(d):null,i=m?Number(m):null,p=h?Number(h):null,e=t("#createShiftPatternError"),s=t("#createShiftPatternOk");if(e&&(e.textContent=""),s&&(s.style.display="none"),!l){e&&(e.textContent="El nombre del patrón es obligatorio.");return}if(!u){e&&(e.textContent="La descripción es obligatoria.");return}if(!a||isNaN(a)||a<1){e&&(e.textContent="Los días de trabajo son obligatorios y deben ser un número mayor a 0.");return}if(i===null||isNaN(i)||i<0){e&&(e.textContent="Los días de descanso son obligatorios y deben ser 0 o más.");return}const o=n.submitter||t('#createShiftPatternForm button[type="submit"]');o&&(o.disabled=!0);try{const r=await v("/api/shift-patterns/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:l,code:b,description:u,workDays:a,restDays:i,startDay:p,active:y})});if(!r.ok){let c="";try{c=await r.text()}catch{}throw c||(c=`Error ${r.status}`),new Error(c)}s&&(s.style.display="block"),setTimeout(()=>{f("/private/shift-patterns/table-view")},600)}catch(r){e&&(e.textContent=r.message)}finally{o&&(o.disabled=!1)}}function S(){t("#createShiftPatternForm")?.addEventListener("submit",P)}function C(){t("#cancelCreateShiftPattern")?.addEventListener("click",n=>{n.preventDefault(),f("/private/shift-patterns/table-view")})}function D(){t("#closeCreateShiftPattern")?.addEventListener("click",n=>{n.preventDefault(),f("/private/shift-patterns/table-view")})}(function(){S(),C(),D()})();
