import{f as d}from"../../../auth.js";import{n as l}from"../../../navigation-handler.js";const n=e=>document.querySelector(e);async function f(e){e.preventDefault();const a=n("#inviteUsername")?.value?.trim(),c=n("#inviteMail")?.value?.trim(),u=Array.from(document.querySelectorAll('input[name="inviteRoleIds"]:checked')).map(t=>Number(t.value)),m=Array.from(document.querySelectorAll('input[name="inviteClientIds"]:checked')).map(t=>Number(t.value)),v=Number(n("#inviteEmployeeId")?.value)||null,i=n("#inviteUserError"),r=n("#inviteUserSuccess");if(i&&(i.textContent=""),r&&(r.style.display="none"),!a||!c){i&&(i.textContent="Nombre de usuario y correo electrÃ³nico son obligatorios.");return}const s=e.submitter||n('#inviteUserForm button[type="submit"]');s&&(s.disabled=!0);try{const t=await d("/api/users/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,mail:c,roleIds:u.length?u:null,clientIds:m.length?m:null,employeeId:v})});if(!t.ok){let o="";try{o=await t.text()}catch{}throw o||(o=`Error ${t.status}`),new Error(o)}r&&(r.style.display="block"),setTimeout(()=>{l("/private/users/table-view")},900)}catch(t){i&&(i.textContent=t.message)}finally{s&&(s.disabled=!1)}}function b(){n("#inviteUserForm")?.addEventListener("submit",f)}function p(){n("#cancelInviteUser")?.addEventListener("click",e=>{e.preventDefault(),l("/private/users/table-view")})}function y(){n("#closeInviteUser")?.addEventListener("click",e=>{e.preventDefault(),l("/private/users/table-view")})}(function(){b(),p(),y()})();
