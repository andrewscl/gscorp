import{f as h}from"../../auth.js";import{n as u}from"../../navigation-handler.js";const t=n=>document.querySelector(n);async function k(n){n.preventDefault();const l=t("#bulkSite")?.value,c=t("#bulkStartDate")?.value,f=t("#bulkEndDate")?.value,d=t("#bulkStartTime")?.value,b=t("#bulkEndTime")?.value,a=t("#bulkPlannedGuards")?.value,m=Array.from(document.querySelectorAll('input[name="weekDays"]:checked')).map(i=>i.value),e=t("#createShiftsBulkError"),r=t("#createShiftsBulkOk");if(e&&(e.textContent=""),r&&(r.style.display="none"),!l){e&&(e.textContent="Debe seleccionar un sitio.");return}if(!c){e&&(e.textContent="Debe ingresar una fecha de inicio.");return}if(!f){e&&(e.textContent="Debe ingresar una fecha de término.");return}if(!d){e&&(e.textContent="Debe ingresar la hora de inicio.");return}if(!b){e&&(e.textContent="Debe ingresar la hora de término.");return}if(!a||isNaN(a)||a<1){e&&(e.textContent="Debe ingresar una cantidad válida de guardias por turno.");return}if(!m.length){e&&(e.textContent="Debe seleccionar al menos un día de la semana.");return}const s=n.submitter||t('#createShiftsBulkForm button[type="submit"]');s&&(s.disabled=!0);try{const i=await h("/api/shifts/bulk-create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({siteId:l,startDate:c,endDate:f,weekDays:m,startTime:d,endTime:b,plannedGuards:Number(a)})});if(!i.ok){let o="";try{o=await i.text()}catch{}throw o||(o=`Error ${i.status}`),new Error(o)}r&&(r.style.display="block"),setTimeout(()=>{u("/private/shifts/table-view")},700)}catch(i){e&&(e.textContent=i.message)}finally{s&&(s.disabled=!1)}}function v(){t("#createShiftsBulkForm")?.addEventListener("submit",k)}function p(){t("#cancelCreateShiftsBulk")?.addEventListener("click",n=>{n.preventDefault(),u("/private/shifts/table-view")})}function C(){t("#closeCreateShiftsBulk")?.addEventListener("click",n=>{n.preventDefault(),u("/private/shifts/table-view")})}(function(){v(),p(),C()})();
