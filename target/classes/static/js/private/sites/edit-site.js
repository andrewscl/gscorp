import{f as l}from"../../auth.js";import{n as u}from"../../navigation-handler.js";const o=document.querySelector("#deleteSiteBtn");o&&o.addEventListener("click",async()=>{const s=o.getAttribute("data-id");if(!(!s||!window.confirm("¿Eliminar este sitio? Esta acción no se puede deshacer."))){o.disabled=!0;try{const t=await l(`/api/sites/${s}`,{method:"DELETE"});if(!t.ok){const i=await t.text().catch(()=>"");throw new Error(i||`No se pudo eliminar (HTTP ${t.status})`)}u("/private/sites/table-view",!0)}catch(t){alert(t.message||"Error al eliminar el sitio."),o.disabled=!1}}});const a=document.querySelector("#editSiteForm");a&&a.addEventListener("submit",async s=>{s.preventDefault();const n=a.querySelector('button[type="submit"]').getAttribute("data-id");if(!n)return;const t=new FormData(a),i={};t.forEach((e,r)=>{r==="active"?i[r]=a.querySelector("#siteActive").checked:i[r]=e});const c=document.getElementById("editSiteError"),d=document.getElementById("editSiteOk");c.textContent="",d.style.display="none";try{const e=await l(`/api/sites/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!e.ok){const r=await e.text().catch(()=>"");throw new Error(r||`No se pudo guardar (HTTP ${e.status})`)}d.style.display="",u("/private/sites/table-view",!0)}catch(e){c.textContent=e.message||"Error al guardar el sitio."}});
