import{f}from"../../auth.js";import{n as d}from"../../navigation-handler.js";console.log("create-client.js cargado");const t=e=>document.querySelector(e);function v(){const e=t("#clientFormMessage");e&&(e.textContent="",e.classList.remove("error","success"))}function c(e,r){const n=t("#clientFormMessage");n&&(n.textContent=r,n.classList.add(e))}function g({name:e,contactEmail:r}){return e?r&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)?(c("error","El correo electrónico no es válido."),!1):!0:(c("error","El nombre es obligatorio."),!1)}async function h(e){e.preventDefault();const r=t("#clientName")?.value?.trim(),n=t("#clientLegalName")?.value?.trim()||null,s=t("#clientTaxId")?.value?.trim()||null,i=t("#clientEmail")?.value?.trim()||null,l=t("#clientPhone")?.value?.trim()||null,m=!!t("#clientActive")?.checked;v();const a={name:r,legalName:n,taxId:s,contactEmail:i,contactPhone:l,active:m};if(g(a))try{const o=await f("/api/clients/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok){const u=await o.text().catch(()=>"Error desconocido");throw new Error(u||"No se pudo crear el cliente.")}c("success","Cliente creado correctamente."),setTimeout(()=>{d("/private/clients/table-view")},1e3)}catch(o){c("error",o.message||"Hubo un error al crear el cliente.")}}function p(){const e=t("#createClientForm");e&&e.addEventListener("submit",h)}(function(){p()})();
