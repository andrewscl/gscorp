const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["private/sites/view-site.js","auth.js"])))=>i.map(i=>d[i]);
import{f as p}from"./auth.js";const h="modulepreload",b=function(t){return"/"+t},m={},d=function(o,e,i){let a=Promise.resolve();if(e&&e.length>0){let w=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),r=s?.nonce||s?.getAttribute("nonce");a=w(e.map(c=>{if(c=b(c),c in m)return;m[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const l=document.createElement("link");if(l.rel=u?"stylesheet":h,u||(l.as="script"),l.crossOrigin="",l.href=c,r&&l.setAttribute("nonce",r),document.head.appendChild(l),u)return new Promise((g,y)=>{l.addEventListener("load",g),l.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(s){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=s,window.dispatchEvent(r),!r.defaultPrevented)throw s}return a.then(s=>{for(const r of s||[])r.status==="rejected"&&n(r.reason);return o().catch(n)})},v=(t,o,e)=>{const i=t[o];return i?typeof i=="function"?i():Promise.resolve(i):new Promise((a,n)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+o+(o.split("/").length!==e?". Note that variables only represent file names one level deep.":""))))})};async function k(t,o=!1){const e=E(t),i=document.body.getAttribute("data-layout");if(t==="/public/home"){console.warn("[navigateTo] Redirigiendo a index-view para /public/home"),window.location.href="/public/home";return}if(!o&&e!==i){console.warn(`[navigateTo] Cambio de layout: 
                        ${i} -> ${e}`);const s=localStorage.getItem("jwt");if((e==="private"||e==="admin")&&s){sessionStorage.setItem("postLoginTarget",t),window.location.href=`/shell/${e}`;return}sessionStorage.setItem("postLoginTarget",t),window.location.href=`/shell/${e}`;return}try{const s=await L(t,e);if(!s)throw new Error("No content");const r=document.getElementById("content");if(!r)throw new Error("No se encontró el contenedor #content");document.dispatchEvent(new CustomEvent("fragment:will-unload",{detail:{path:t}})),r.innerHTML=s,await P(r,t),await _(t,r),window.history.pushState({},"",t),console.log(`[navigateTo] Ruta cargada dinámicamente: ${t}`),document.dispatchEvent(new CustomEvent("route:loaded",{detail:{path:t}}))}catch(s){console.error(`[navigateTo] Error: ${s.message}`),alert("Error al navegar a la ruta solicitada.")}}function E(t){return t==="/auth"||t.startsWith("/auth/")?"auth":t==="/private"||t.startsWith("/private/")||t==="/admin"||t.startsWith("/admin/")?"private":"public"}async function L(t,o){const e=localStorage.getItem("jwt"),i=t.includes("?")?"&":"?",a=`${t}${i}fragment=1`;return o==="private"&&e?p(a).then(n=>n.ok?n.text():null):fetch(a).then(n=>n.ok?n.text():null)}async function P(t,o){const e=t.querySelectorAll('script[type="module"]');for(const i of e)if(i.src){const a=new URL(i.src,location.origin);a.searchParams.set("v",Date.now());const n=await import(a.href);typeof n.init=="function"&&n.init({container:t,path:o})}else{const a=URL.createObjectURL(new Blob([i.textContent],{type:"text/javascript"})),n=await import(a);URL.revokeObjectURL(a),typeof n.init=="function"&&n.init({container:t,path:o})}}async function _(t,o){if(t==="/public/contact"){const{setupContact:e}=await v(Object.assign({"./contact.js":()=>d(()=>import("./contact.js"),[])}),`./contact.js?v=${Date.now()}`,2);typeof e=="function"&&await e({container:o,path:t})}if(t.startsWith("/private/sites/view-site")){const{init:e}=await v(Object.assign({"./private/sites/view-site.js":()=>d(()=>import("./private/sites/view-site.js"),__vite__mapDeps([0,1]))}),`./private/sites/view-site.js?v=${Date.now()}`,4);typeof e=="function"&&e({container:o,path:t})}}export{k as n};
