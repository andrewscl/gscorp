const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["private/sites/view-site.js","auth.js"])))=>i.map(i=>d[i]);
import{f as p}from"./auth.js";const b="modulepreload",h=function(t){return"/"+t},d={},m=function(o,e,r){let s=Promise.resolve();if(e&&e.length>0){let w=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),i=a?.nonce||a?.getAttribute("nonce");s=w(e.map(c=>{if(c=h(c),c in d)return;d[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const l=document.createElement("link");if(l.rel=u?"stylesheet":b,u||(l.as="script"),l.crossOrigin="",l.href=c,i&&l.setAttribute("nonce",i),document.head.appendChild(l),u)return new Promise((y,g)=>{l.addEventListener("load",y),l.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(a){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a}return s.then(a=>{for(const i of a||[])i.status==="rejected"&&n(i.reason);return o().catch(n)})},v=(t,o,e)=>{const r=t[o];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((s,n)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+o+(o.split("/").length!==e?". Note that variables only represent file names one level deep.":""))))})};async function R(t,o=!1){const e=E(t),r=document.body.getAttribute("data-layout");if(t==="/public/home"){console.warn("[navigateTo] Redirigiendo a index-view para /public/home"),window.location.href="/public/home";return}const n=e!==r;if(!o&&n){console.warn(`[navigateTo] Cambio de layout: 
                        ${r} -> ${e}`),sessionStorage.setItem("postLoginTarget",t),window.location.href=`/shell/${e}`;return}console.log({force:o,changeLayout:n,targetLayout:e,currentLayout:r}),console.log("isLayoutLoaded(targetLayout):",isLayoutLoaded(e));try{const a=await L(t,e);if(!a)throw new Error("No content");const i=document.getElementById("content");if(!i)throw new Error("No se encontró el contenedor #content");document.dispatchEvent(new CustomEvent("fragment:will-unload",{detail:{path:t}})),i.innerHTML=a,await _(i,t),await P(t,i),window.history.pushState({},"",t),console.log(`[navigateTo] Ruta cargada dinámicamente: ${t}`),document.dispatchEvent(new CustomEvent("route:loaded",{detail:{path:t}}))}catch(a){console.error(`[navigateTo] Error: ${a.message}`),alert("Error al navegar a la ruta solicitada.")}}function E(t){return t==="/auth"||t.startsWith("/auth/")?"auth":t==="/private"||t.startsWith("/private/")||t==="/admin"||t.startsWith("/admin/")?"private":"public"}async function L(t,o){const e=localStorage.getItem("jwt"),r=t.includes("?")?"&":"?",s=`${t}${r}fragment=1`;return o==="private"&&e?p(s).then(n=>n.ok?n.text():null):fetch(s).then(n=>n.ok?n.text():null)}async function _(t,o){const e=t.querySelectorAll('script[type="module"]');for(const r of e)if(r.src){const s=new URL(r.src,location.origin);s.searchParams.set("v",Date.now());const n=await import(s.href);typeof n.init=="function"&&n.init({container:t,path:o})}else{const s=URL.createObjectURL(new Blob([r.textContent],{type:"text/javascript"})),n=await import(s);URL.revokeObjectURL(s),typeof n.init=="function"&&n.init({container:t,path:o})}}async function P(t,o){if(t==="/public/contact"){const{setupContact:e}=await v(Object.assign({"./contact.js":()=>m(()=>import("./contact.js"),[])}),`./contact.js?v=${Date.now()}`,2);typeof e=="function"&&await e({container:o,path:t})}if(t.startsWith("/private/sites/view-site")){const{init:e}=await v(Object.assign({"./private/sites/view-site.js":()=>m(()=>import("./private/sites/view-site.js"),__vite__mapDeps([0,1]))}),`./private/sites/view-site.js?v=${Date.now()}`,4);typeof e=="function"&&e({container:o,path:t})}}export{R as n};
