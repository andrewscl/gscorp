const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["private/sites/view-site.js","auth.js"])))=>i.map(i=>d[i]);
import{f as b}from"./auth.js";const E="modulepreload",h=function(e){return"/"+e},f={},m=function(o,t,r){let a=Promise.resolve();if(t&&t.length>0){let g=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),i=s?.nonce||s?.getAttribute("nonce");a=g(t.map(c=>{if(c=h(c),c in f)return;f[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const l=document.createElement("link");if(l.rel=u?"stylesheet":E,u||(l.as="script"),l.crossOrigin="",l.href=c,i&&l.setAttribute("nonce",i),document.head.appendChild(l),u)return new Promise((y,p)=>{l.addEventListener("load",y),l.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(s){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s}return a.then(s=>{for(const i of s||[])i.status==="rejected"&&n(i.reason);return o().catch(n)})},v=(e,o,t)=>{const r=e[o];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((a,n)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+o+(o.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})};let w=null;async function j(e,o=!1){if(e===w&&!o){console.warn(`[navigateTo] Ruta ya cargada: ${e}. Evitando carga duplicada.`);return}console.log(`[navigateTo] Actualizando currentRoute a: ${e}`),w=e;const t=L(e),r=document.body.getAttribute("data-layout");if(e==="/public/home"){console.warn("[navigateTo] Redirigiendo a index-view para /public/home"),window.location.href="/public/home";return}const n=t!==r;if(!o&&n){console.warn(`[navigateTo] Cambio de layout: 
                        ${r} -> ${t}`),sessionStorage.setItem("postLoginTarget",e),window.location.href=`/shell/${t}`;return}console.log({force:o,changeLayout:n,targetLayout:t,currentLayout:r});try{const s=await R(e,t);if(!s)throw new Error("No content");const i=document.getElementById("content");if(!i)throw new Error("No se encontró el contenedor #content");document.dispatchEvent(new CustomEvent("fragment:will-unload",{detail:{path:e}})),i.innerHTML=s,await _(i,e),await P(e,i),window.history.pushState({},"",e),console.log(`[navigateTo] Ruta cargada dinámicamente: ${e}`),document.dispatchEvent(new CustomEvent("route:loaded",{detail:{path:e}}))}catch(s){console.error(`[navigateTo] Error: ${s.message}`),alert("Error al navegar a la ruta solicitada.")}}function L(e){return e==="/auth"||e.startsWith("/auth/")?"auth":e==="/private"||e.startsWith("/private/")||e==="/admin"||e.startsWith("/admin/")?"private":"public"}async function R(e,o){const t=localStorage.getItem("jwt"),r=e.includes("?")?"&":"?",a=`${e}${r}fragment=1`;return o==="private"&&t?b(a).then(n=>n.ok?n.text():null):fetch(a).then(n=>n.ok?n.text():null)}async function _(e,o){const t=e.querySelectorAll('script[type="module"]');for(const r of t)if(r.src){const a=new URL(r.src,location.origin);a.searchParams.set("v",Date.now());const n=await import(a.href);typeof n.init=="function"&&n.init({container:e,path:o})}else{const a=URL.createObjectURL(new Blob([r.textContent],{type:"text/javascript"})),n=await import(a);URL.revokeObjectURL(a),typeof n.init=="function"&&n.init({container:e,path:o})}}async function P(e,o){if(e==="/public/contact"){const{setupContact:t}=await v(Object.assign({"./contact.js":()=>m(()=>import("./contact.js"),[])}),`./contact.js?v=${Date.now()}`,2);typeof t=="function"&&await t({container:o,path:e})}if(e.startsWith("/private/sites/view-site")){const{init:t}=await v(Object.assign({"./private/sites/view-site.js":()=>m(()=>import("./private/sites/view-site.js"),__vite__mapDeps([0,1]))}),`./private/sites/view-site.js?v=${Date.now()}`,4);typeof t=="function"&&t({container:o,path:e})}}export{j as n};
