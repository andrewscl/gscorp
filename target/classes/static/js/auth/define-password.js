import{f as d}from"../auth.js";import{n as m}from"../navigation-handler.js";const e=n=>document.querySelector(n);async function u(n){n.preventDefault();const o=e("#newPassword")?.value?.trim(),f=e("#confirmPassword")?.value?.trim(),c=e("#invitationToken")?.value?.trim(),t=e("#definePasswordError"),r=e("#definePasswordSuccess");if(t&&(t.textContent=""),r&&(r.style.display="none"),!o||!f){t&&(t.textContent="Por favor ingresa y confirma tu contraseña.");return}if(o.length<6){t&&(t.textContent="La contraseña debe tener al menos 6 caracteres.");return}if(o!==f){t&&(t.textContent="Las contraseñas no coinciden.");return}const i=n.submitter||e('#definePasswordForm button[type="submit"]');i&&(i.disabled=!0);try{const s=await d("/api/users/set-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:c,password:o})});if(!s.ok){let a="";try{a=await s.text()}catch{}throw a||(a=`Error ${s.status}`),new Error(a)}r&&(r.style.display="block"),e("#definePasswordForm").style.display="none",setTimeout(()=>{m("/login")},1300)}catch(s){t&&(t.textContent=s.message)}finally{i&&(i.disabled=!1)}}function l(){e("#definePasswordForm")?.addEventListener("submit",u)}(function(){l()})();
