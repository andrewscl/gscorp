<section th:fragment="content" class="card supervisor-visit" style="max-width:520px;padding:1rem">
  <h3 style="margin-top:0">Registro de Visita de Supervisor</h3>

  <!-- Mensaje de estado y nombre del sitio más cercano -->
  <div id="visit-status" style="margin:.5rem 0;color:#444">Detectando instalación más cercana...</div>
  <div id="visit-site-info" style="margin-bottom:0.5rem;color:#0077b6;font-weight:bold"></div>

  <form id="visit-widget"
        data-visit-endpoint="/api/supervisor-visits/register"
        enctype="multipart/form-data"
        autocomplete="off">

    <!-- Botón de registro (puedes ocultarlo dinámicamente si hace falta) -->
    <button id="visit-mark" class="btn btn-primary" type="submit" style="display:none">
      Registrar visita
    </button>

    <!-- Campo de descripción -->
    <div class="form-group" style="margin-top:1rem;">
      <label for="visit-description">Descripción</label>
      <textarea id="visit-description" name="description" placeholder="Describa la visita o hallazgos..." rows="2" style="width:100%;resize:vertical;"></textarea>
    </div>

    <!-- Contenedor para fotografía -->
    <div class="form-group" style="margin-top:1rem;">
      <label for="visit-photo">Fotografía (opcional)</label>
      <input type="file" id="visit-photo" name="photo" accept="image/*" capture="environment">
      <div id="visit-photo-preview" style="margin-top:.5rem;"></div>
    </div>

    <!-- Contenedor para video -->
    <div class="form-group" style="margin-top:1rem;">
      <label for="visit-video">Video (opcional)</label>
      <input type="file" id="visit-video" name="video" accept="video/*" capture="environment">
      <div id="visit-video-preview" style="margin-top:.5rem;"></div>
    </div>

    <!-- Botones de acción -->
    <div class="modal-footer" style="margin-top:1.5rem; display:flex; gap:.5rem; justify-content:flex-end;">
      <button type="submit" class="btn-primary" id="save-visit-btn">Guardar visita</button>
      <button type="button" class="btn-secondary" id="cancel-visit-btn">Cancelar</button>
    </div>

  </form>

  <!-- Mapa de ubicación actual y del sitio -->
  <div id="visit-map-container" style="width:100%;height:220px;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px -4px #cbd5e1;margin-bottom:1rem;background:#f3f4f6">
    <div id="visit-map" style="width:100%;height:100%"></div>
  </div>

  <script type="module" th:src="@{/js/private/site-supervision-visits/create-site-supervision-visit.js}" defer></script>
</section>