// Scoped SCSS para client-dashboard-fragment.html
// Reglas anidadas y contenidas bajo #client-dashboard-root para no afectar estilos globales.

#client-dashboard-root {
  // defensas locales
  box-sizing: border-box;
  max-width: 100%;

  // permitir que elementos flex/grid se encojan en lugar de forzar overflow
  .kpis,
  .charts,
  .card {
    min-width: 0;
    box-sizing: border-box;
  }

  // KPI row (se heredan estilos globales, aquÃ­ aseguramos shrink)
  .kpis {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
    align-items: stretch;

    .kpi-card {
      flex: 1 1 200px;
      min-width: 160px;
      box-sizing: border-box;
    }
  }

  // Reglas generales para filas de charts
  .charts {
    display: grid;
    gap: 1.25rem;
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;

    // Default: 3 columnas en pantallas anchas, adaptativo en los breakpoints
    @media (min-width: 981px) {
      grid-template-columns: repeat(3, 1fr);
    }
    @media (max-width: 980px) {
      grid-template-columns: repeat(2, 1fr);
    }
    @media (max-width: 640px) {
      grid-template-columns: 1fr;
    }

    .card {
      box-sizing: border-box;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      min-height: 220px;

      h5 { margin: 0 0 0.6rem 0; }

      // Protecciones locales para contenedores de ECharts
      > div[id^="chart-"] {
        width: 100% !important;
        max-width: 100% !important;
        min-width: 0 !important;
        box-sizing: border-box !important;
        overflow: hidden !important;
        height: 240px;
        min-height: 180px;
        border-radius: 8px;
        background: transparent;
      }
    }
  }

  // Fila "weekly" con 3 charts
  .charts.weekly {
    display: grid;
    gap: 1.25rem;
    grid-template-columns: repeat(3, 1fr);

    @media (max-width: 980px) { grid-template-columns: repeat(2, 1fr); }
    @media (max-width: 640px)  { grid-template-columns: 1fr; }

    .card {
      overflow: hidden;

      > div[id^="chart-"] {
        height: 260px !important;
        min-height: 200px !important;
      }
    }
  }

  // Fila separada "full-width" para visitas por sitio (ocupa toda la anchura)
  .charts.full-width {
    display: block;
    margin-top: 0.75rem;

    .card {
      width: 100%;
      max-width: 100%;
      box-sizing: border-box;
      overflow: hidden;
      margin-bottom: 0.75rem;

      > div[id^="chart-"] {
        height: 260px !important;
        min-height: 200px !important;
      }
    }
  }

  // Protecciones adicionales solo dentro del fragmento
  img, svg, canvas {
    max-width: 100%;
    height: auto;
    display: block;
    box-sizing: border-box;
  }

  // Evitar que textos extremos rompan el layout dentro del fragmento
  * {
    word-wrap: break-word;
    word-break: break-word;
  }
}