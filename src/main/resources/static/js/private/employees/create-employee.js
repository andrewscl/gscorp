import{f as z}from"../../auth.js";import{n as h}from"../../navigation-handler.js";console.log("create-employee.js cargado");const t=o=>document.querySelector(o);async function J(o){o.preventDefault();const i=t("#employeeName")?.value?.trim(),v=t("#employeeFatherSurname")?.value?.trim()||null,f=t("#employeeMotherSurname")?.value?.trim()||null,S=t("#employeeRut")?.value?.trim()||null,b=t("#employeeMail")?.value?.trim()||null,E=t("#employeePhone")?.value?.trim()||null,k=t("#employeeSecondaryPhone")?.value?.trim()||null,I=t("#employeeGender")?.value?.trim()||null,P=t("#employeeNationality")?.value?.trim()||null,D=t("#employeeMaritalStatus")?.value?.trim()||null,A=t("#employeeStudyLevel")?.value?.trim()||null;let s=[];const m=t("#employeeProfessions");m&&(s=Array.from(m.selectedOptions).map(e=>e.value).filter(Boolean));const C=t("#employeePrevitionalSystem")?.value?.trim()||null,w=t("#employeePensionEntity")?.value?.trim()||null,T=t("#employeeHealthSystem")?.value?.trim()||null,g=t("#employeeHealthEntity")?.value?.trim()||null,x=t("#employeePaymentMethod")?.value?.trim()||null,B=t("#employeeBank")?.value?.trim()||null,M=t("#employeeBankAccountType")?.value?.trim()||null,N=t("#employeeBankAccountNumber")?.value?.trim()||null,j=t("#employeeContractType")?.value?.trim()||null,L=t("#employeeWorkSchedule")?.value?.trim()||null,F=t("#employeeShiftSystem")?.value?.trim()||null,O=t("#employeeShiftPattern")?.value?.trim()||null,H=t("#employeePosition")?.value?.trim()||null,q=t("#employeeAddress")?.value?.trim()||null,W=t("#employeeHireDate")?.value||null,G=t("#employeeBirthDate")?.value||null,R=t("#employeeExitDate")?.value||null,U=!!t("#employeeActive")?.checked,u=t("#employeeUser")?.value||null;let c=[];const d=t("#employeeProjects");d&&(c=Array.from(d.selectedOptions).map(e=>e.value).filter(Boolean));const l=t("#employeePhoto");let r=null;l&&l.files&&l.files[0]&&(r=l.files[0]);const n=t("#createEmployeeError"),p=t("#createEmployeeOk");if(n&&(n.textContent=""),p&&(p.style.display="none"),!i){n&&(n.textContent="El nombre es obligatorio.");return}if(!u){n&&(n.textContent="Debe seleccionar un usuario asociado.");return}try{const e=new FormData;e.append("name",i),e.append("fatherSurname",v),e.append("motherSurname",f),e.append("rut",S),e.append("mail",b),e.append("phone",E),e.append("secondaryPhone",k),e.append("gender",I),e.append("nationalityId",P),e.append("maritalStatus",D),e.append("studyLevel",A),s.forEach(a=>e.append("professionIds",a)),e.append("previtionalSystem",C),e.append("pensionEntity",w),e.append("healthSystem",T),e.append("healthEntity",g),e.append("paymentMethod",x),e.append("bankId",B),e.append("bankAccountType",M),e.append("bankAccountNumber",N),e.append("contractType",j),e.append("workSchedule",L),e.append("shiftSystem",F),e.append("shiftPatternId",O),e.append("positionId",H),e.append("address",q),e.append("hireDate",W),e.append("birthDate",G),e.append("exitDate",R),e.append("active",U),e.append("userId",u),c.forEach(a=>e.append("projectIds",a)),r&&e.append("photo",r);const y=await z("/api/employees/create",{method:"POST",body:e});if(!y.ok){const a=await y.text().catch(()=>"");throw new Error(a||"No se pudo crear el empleado")}p&&(p.style.display="block"),setTimeout(()=>{h("/private/employees/table-view")},600)}catch(e){n&&(n.textContent=e.message)}}function K(o){o.preventDefault(),h("/private/employees/table-view")}function Q(){t("#createEmployeeForm")?.addEventListener("submit",J),t("#cancelCreateEmployee")?.addEventListener("click",K)}(function(){Q()})();
