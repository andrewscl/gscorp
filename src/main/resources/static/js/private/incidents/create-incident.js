import{f}from"../../auth.js";import{n as d}from"../../navigation-handler.js";console.log("create-incident.js cargado");const e=i=>document.querySelector(i);async function m(i){i.preventDefault();const o=e("#incidentSite")?.value||"",a=e("#incidentType")?.value||"",l=e("#incidentDescription")?.value?.trim()||"",p=e("#incidentSlaMinutes")?.value||"30",t=e("#createIncidentError"),c=e("#createIncidentOk");if(t&&(t.textContent=""),c&&(c.style.display="none"),!o){t&&(t.textContent="Debes seleccionar un sitio.");return}if(!a){t&&(t.textContent="Debes seleccionar un tipo de incidente.");return}try{const n=new FormData;n.append("siteId",o),n.append("typeId",a),n.append("description",l),n.append("slaMinutes",p);const r=await f("/api/incidents/create",{method:"POST",body:n});if(!r.ok){const u=await r.text().catch(()=>"");throw new Error(u||"No se pudo crear el incidente")}c&&(c.style.display="block"),c.textContent="Incidente creado âœ…",setTimeout(()=>{d("/private/incidents/table-view")},600)}catch(n){t&&(t.textContent=n.message)}}function s(i){i.preventDefault(),d("/private/incidents/table-view")}function v(){e("#createIncidentForm")?.addEventListener("submit",m),e("#cancelCreateIncident")?.addEventListener("click",s),e("#goToIncidentTable")?.addEventListener("click",s)}(function(){v()})();
