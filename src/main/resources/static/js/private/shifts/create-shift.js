import{f as u}from"../../auth.js";import{n as f}from"../../navigation-handler.js";const e=i=>document.querySelector(i);async function h(i){i.preventDefault();const c=e("#shiftSite")?.value,l=e("#shiftStartTs")?.value,d=e("#shiftEndTs")?.value,a=e("#shiftPlannedGuards")?.value,t=e("#createShiftError"),r=e("#createShiftOk");if(t&&(t.textContent=""),r&&(r.style.display="none"),!c){t&&(t.textContent="Debe seleccionar un sitio.");return}if(!l){t&&(t.textContent="Debe ingresar la fecha y hora de inicio.");return}if(!d){t&&(t.textContent="Debe ingresar la fecha y hora de término.");return}if(!a||isNaN(a)||a<1){t&&(t.textContent="Debe ingresar una cantidad válida de guardias planificados.");return}const s=i.submitter||e('#createShiftForm button[type="submit"]');s&&(s.disabled=!0);try{const n=await u("/api/shifts/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({siteId:c,startTs:l,endTs:d,plannedGuards:Number(a)})});if(!n.ok){let o="";try{o=await n.text()}catch{}throw o||(o=`Error ${n.status}`),new Error(o)}r&&(r.style.display="block"),setTimeout(()=>{f("/private/shifts/table-view")},600)}catch(n){t&&(t.textContent=n.message)}finally{s&&(s.disabled=!1)}}function b(){e("#createShiftForm")?.addEventListener("submit",h)}function m(){e("#cancelCreateShift")?.addEventListener("click",i=>{i.preventDefault(),f("/private/shifts/table-view")})}function p(){e("#closeCreateShift")?.addEventListener("click",i=>{i.preventDefault(),f("/private/shifts/table-view")})}(function(){b(),m(),p()})();
