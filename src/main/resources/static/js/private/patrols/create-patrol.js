import{f as p}from"../../auth.js";import{n as d}from"../../navigation-handler.js";const e=t=>document.querySelector(t);async function v(t){t.preventDefault();const r=e(".alert-success"),a=e(".alert-error"),o=Number(e("#siteId")?.value),c=e("#patrolName")?.value?.trim(),i=Number(e("#dayFrom")?.value),l=Number(e("#dayTo")?.value),u=e("#startTime")?.value;if(!o||!c||!i||!l||!u){s(a,"Por favor, complete todos los campos obligatorios.");return}try{const n=await p("/api/patrols/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({siteId:o,patrolName:c,dayFrom:i,dayTo:l,startTime:u})});if(!n.ok){const m=await n.json();s(a,`Error: ${m.message||"Ocurrió un problema al enviar el formulario."}`);return}s(r,"¡Formulario enviado correctamente!"),setTimeout(()=>{d("/private/patrols/table-view")},3e3)}catch(n){console.error(`[onClickCreate] Ocurrio un problema: ${n.message}`,n),s(a,"Error inesperado. Intente más tarde.")}}async function y(t){t.preventDefault();const r=e(".alert-cancel");s(r,"La creación de la ronda de supervisión ha sido cancelada."),setTimeout(()=>{d("/private/patrols/table-view")},3e3)}function s(t,r,a=5e3){const o=e(".patrol-alert-container");o.style.display="block";const c=t.querySelector(".alert-message");c.textContent=r,t.classList.add("alert-show"),setTimeout(()=>{t.classList.remove("alert-show"),o.style.display="none"},a)}function f(){e("#createPatrolBtn")?.addEventListener("click",v),e("#cancelCreatePatrolBtn")?.addEventListener("click",y)}(function(){f()})();
