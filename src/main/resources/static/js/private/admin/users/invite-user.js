import{f as v}from"../../../auth.js";import{n as a}from"../../../navigation-handler.js";const n=e=>document.querySelector(e);async function d(e){e.preventDefault();const l=n("#inviteUsername")?.value?.trim(),c=n("#inviteMail")?.value?.trim(),u=Array.from(document.querySelectorAll('input[name="inviteRoleIds"]:checked')).map(t=>Number(t.value)),m=Array.from(document.querySelectorAll('input[name="inviteClientIds"]:checked')).map(t=>Number(t.value)),i=n("#inviteUserError"),r=n("#inviteUserSuccess");if(i&&(i.textContent=""),r&&(r.style.display="none"),!l||!c){i&&(i.textContent="Nombre de usuario y correo electrÃ³nico son obligatorios.");return}const s=e.submitter||n('#inviteUserForm button[type="submit"]');s&&(s.disabled=!0);try{const t=await v("/api/users/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l,mail:c,roleIds:u.length?u:null,clientIds:m.length?m:null})});if(!t.ok){let o="";try{o=await t.text()}catch{}throw o||(o=`Error ${t.status}`),new Error(o)}r&&(r.style.display="block"),setTimeout(()=>{a("/private/users/table-view")},900)}catch(t){i&&(i.textContent=t.message)}finally{s&&(s.disabled=!1)}}function f(){n("#inviteUserForm")?.addEventListener("submit",d)}function b(){n("#cancelInviteUser")?.addEventListener("click",e=>{e.preventDefault(),a("/private/users/table-view")})}function p(){n("#closeInviteUser")?.addEventListener("click",e=>{e.preventDefault(),a("/private/users/table-view")})}(function(){f(),b(),p()})();
