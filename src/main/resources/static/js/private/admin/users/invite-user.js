import{f as v}from"../../../auth.js";import{n as a}from"../../../navigation-handler.js";const e=t=>document.querySelector(t);async function d(t){t.preventDefault();const l=e("#inviteUsername")?.value?.trim(),c=e("#inviteMail")?.value?.trim(),u=e("#inviteRoleIds")?.value?.trim().split(",").map(i=>i.trim()).filter(Boolean).map(Number),m=e("#inviteClientIds")?.value?.trim().split(",").map(i=>i.trim()).filter(Boolean).map(Number),n=e("#inviteUserError"),r=e("#inviteUserSuccess");if(n&&(n.textContent=""),r&&(r.style.display="none"),!l||!c){n&&(n.textContent="Nombre de usuario y correo electrÃ³nico son obligatorios.");return}const s=t.submitter||e('#inviteUserForm button[type="submit"]');s&&(s.disabled=!0);try{const i=await v("/api/users/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l,mail:c,roleIds:u.length?u:null,clientIds:m.length?m:null})});if(!i.ok){let o="";try{o=await i.text()}catch{}throw o||(o=`Error ${i.status}`),new Error(o)}r&&(r.style.display="block"),setTimeout(()=>{a("/private/users/table-view")},900)}catch(i){n&&(n.textContent=i.message)}finally{s&&(s.disabled=!1)}}function f(){e("#inviteUserForm")?.addEventListener("submit",d)}function p(){e("#cancelInviteUser")?.addEventListener("click",t=>{t.preventDefault(),a("/private/users/table-view")})}function b(){e("#closeInviteUser")?.addEventListener("click",t=>{t.preventDefault(),a("/private/users/table-view")})}(function(){f(),p(),b()})();
