import{f as S}from"../../auth.js";import{n as r}from"../../navigation-handler.js";const e=i=>document.querySelector(i);async function y(i){i.preventDefault();const o=e("#shiftRequestCode")?.value?.trim(),f=e("#shiftRequestSite")?.value,c=e("#shiftRequestType")?.value,l=e("#shiftRequestStartDate")?.value,d=e("#shiftRequestEndDate")?.value||null,m=e("#shiftRequestWeekDays")?.value?.trim()||null,q=e("#shiftRequestShiftDateTime")?.value||null,v=e("#shiftRequestStartTime")?.value||null,R=e("#shiftRequestEndTime")?.value||null,b=e("#shiftRequestLunchTime")?.value||null,h=e("#shiftRequestStatus")?.value,p=e("#shiftRequestDescription")?.value?.trim()||null,t=e("#createShiftRequestError"),n=e("#createShiftRequestOk");if(t&&(t.textContent=""),n&&(n.style.display="none"),!o){t&&(t.textContent="El cÃ³digo es obligatorio.");return}if(!f){t&&(t.textContent="Debe seleccionar un sitio.");return}if(!c){t&&(t.textContent="Debe seleccionar un tipo.");return}if(!l){t&&(t.textContent="La fecha de inicio es obligatoria.");return}if(!h){t&&(t.textContent="Debe seleccionar un estado.");return}const a=i.submitter||e('#createShiftRequestForm button[type="submit"]');a&&(a.disabled=!0);try{const s=await S("/api/shift-requests/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:o,siteId:f,type:c,startDate:l,endDate:d,weekDays:m,shiftDateTime:q,startTime:v,endTime:R,lunchTime:b,status:h,description:p})});if(!s.ok){let u="";try{u=await s.text()}catch{}throw u||(u=`Error ${s.status}`),new Error(u)}n&&(n.style.display="block"),setTimeout(()=>{r("/private/shift-requests/table-view")},600)}catch(s){t&&(t.textContent=s.message)}finally{a&&(a.disabled=!1)}}function C(){e("#createShiftRequestForm")?.addEventListener("submit",y)}function D(){e("#cancelCreateShiftRequest")?.addEventListener("click",i=>{i.preventDefault(),r("/private/shift-requests/table-view")})}function T(){e("#closeCreateShiftRequest")?.addEventListener("click",i=>{i.preventDefault(),r("/private/shift-requests/table-view")})}(function(){C(),D(),T()})();
