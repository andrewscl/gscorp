import{f as c}from"../auth.js";import{n as i}from"../navigation-handler.js";const t=e=>document.querySelector(e);function d(){const e=t("#createRoleModal");e?.classList.remove("hidden"),e?.setAttribute("aria-hidden","false"),t("#newRole")?.focus()}function r(){const e=t("#createRoleModal");e?.classList.add("hidden"),e?.setAttribute("aria-hidden","true"),t("#createRoleError").textContent="",t("#createRoleOk").style.display="none",t("#createRoleForm")?.reset()}function u(e){return e.trim().replace(/\s+/g,"_").toUpperCase()}async function m(e){e.preventDefault();const n=t("#createRoleError"),l=t("#createRoleOk");n.textContent="",l.style.display="none";let a=t("#newRole")?.value||"";if(a=u(a),!a){n.textContent="El nombre del rol es obligatorio.";return}try{const o=await c("/api/roles/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:a})});if(!o.ok){const s=(await o.json().catch(()=>({})))?.message||`Error al crear el rol (HTTP ${o.status}).`;throw new Error(s)}l.style.display="block",setTimeout(()=>{r(),i("/private/admin/roles",!0)},600)}catch(o){n.textContent=o.message||"No se pudo crear el rol."}}function p(){t("#createRoleBtn")?.addEventListener("click",d),t("#closeCreateRole")?.addEventListener("click",r),t("#cancelCreateRole")?.addEventListener("click",r),t("#createRoleForm")?.addEventListener("submit",m),document.addEventListener("keydown",e=>{e.key==="Escape"&&r()}),t("#createRoleModal")?.addEventListener("click",e=>{e.target?.id==="createRoleModal"&&r()})}document.addEventListener("DOMContentLoaded",p);
