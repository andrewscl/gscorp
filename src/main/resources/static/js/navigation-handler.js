const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["private/sites/view-site.js","auth.js"])))=>i.map(i=>d[i]);
import{f as g}from"./auth.js";const h="modulepreload",b=function(e){return"/"+e},m={},v=function(o,t,r){let s=Promise.resolve();if(t&&t.length>0){let l=function(i){return Promise.all(i.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),a=c?.nonce||c?.getAttribute("nonce");s=l(t.map(i=>{if(i=b(i),i in m)return;m[i]=!0;const d=i.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${f}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":h,d||(u.as="script"),u.crossOrigin="",u.href=i,a&&u.setAttribute("nonce",a),document.head.appendChild(u),d)return new Promise((y,p)=>{u.addEventListener("load",y),u.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${i}`)))})}))}function n(c){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=c,window.dispatchEvent(a),!a.defaultPrevented)throw c}return s.then(c=>{for(const a of c||[])a.status==="rejected"&&n(a.reason);return o().catch(n)})},w=(e,o,t)=>{const r=e[o];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((s,n)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+o+(o.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})};async function S(e,o=!1){const t=E(e),r=document.body.getAttribute("data-layout");if(e==="/public/home"){console.warn("[navigateTo] Redirigiendo a index-view para /public/home"),window.location.href="/public/home";return}function n(l){return l==="auth"?!!document.querySelector('link[href*="define-password.css"]'):l==="private"?!!document.querySelector('link[href*="private-dashboard.css"]'):l==="public"?!!document.querySelector('link[href*="index.css"]'):!0}const c=!n(t),a=t!==r;if(!o&&(a||c)){console.warn(`[navigateTo] Cambio de layout: 
                        ${r} -> ${t}`),sessionStorage.setItem("postLoginTarget",e),window.location.href=`/shell/${t}`;return}console.log({force:o,changeLayout:a,isFirstLoad:c,targetLayout:t,currentLayout:r}),console.log("isLayoutLoaded(targetLayout):",n(t));try{const l=await L(e,t);if(!l)throw new Error("No content");const i=document.getElementById("content");if(!i)throw new Error("No se encontró el contenedor #content");document.dispatchEvent(new CustomEvent("fragment:will-unload",{detail:{path:e}})),i.innerHTML=l,await _(i,e),await k(e,i),window.history.pushState({},"",e),console.log(`[navigateTo] Ruta cargada dinámicamente: ${e}`),document.dispatchEvent(new CustomEvent("route:loaded",{detail:{path:e}}))}catch(l){console.error(`[navigateTo] Error: ${l.message}`),alert("Error al navegar a la ruta solicitada.")}}function E(e){return e==="/auth"||e.startsWith("/auth/")?"auth":e==="/private"||e.startsWith("/private/")||e==="/admin"||e.startsWith("/admin/")?"private":"public"}async function L(e,o){const t=localStorage.getItem("jwt"),r=e.includes("?")?"&":"?",s=`${e}${r}fragment=1`;return o==="private"&&t?g(s).then(n=>n.ok?n.text():null):fetch(s).then(n=>n.ok?n.text():null)}async function _(e,o){const t=e.querySelectorAll('script[type="module"]');for(const r of t)if(r.src){const s=new URL(r.src,location.origin);s.searchParams.set("v",Date.now());const n=await import(s.href);typeof n.init=="function"&&n.init({container:e,path:o})}else{const s=URL.createObjectURL(new Blob([r.textContent],{type:"text/javascript"})),n=await import(s);URL.revokeObjectURL(s),typeof n.init=="function"&&n.init({container:e,path:o})}}async function k(e,o){if(e==="/public/contact"){const{setupContact:t}=await w(Object.assign({"./contact.js":()=>v(()=>import("./contact.js"),[])}),`./contact.js?v=${Date.now()}`,2);typeof t=="function"&&await t({container:o,path:e})}if(e.startsWith("/private/sites/view-site")){const{init:t}=await w(Object.assign({"./private/sites/view-site.js":()=>v(()=>import("./private/sites/view-site.js"),__vite__mapDeps([0,1]))}),`./private/sites/view-site.js?v=${Date.now()}`,4);typeof t=="function"&&t({container:o,path:e})}}export{S as n};
